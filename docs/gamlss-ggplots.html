<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="De Bastiani, F.">
<meta name="author" content="Heller, G.">
<meta name="author" content="Kneib, T.">
<meta name="author" content="Mayr, A.">
<meta name="author" content="Julian Merder">
<meta name="author" content="Rigby, R. A.">
<meta name="author" content="Stasinopoulos, M. D.">
<meta name="author" content="Stauffer, Reto">
<meta name="author" content="Umlauf, N,">
<meta name="author" content="Zeileis, A.">

<title>The Functions in gamlss.ggplots – Extra material for GAMLSS packages</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Extra material for GAMLSS packages</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./about.html"> 
<span class="menu-text">About extra materrial for GAMLSS packages</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./gamlss-prepdata.html"> 
<span class="menu-text">The Functions in the Package <code>gamlss.prepdata</code></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./gamlss-ggplots.html" aria-current="page"> 
<span class="menu-text">The Functions in <code>gamlss.ggplots</code></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul class="collapse">
  <li><a href="#sec-introduction" id="toc-sec-introduction" class="nav-link active" data-scroll-target="#sec-introduction">Introduction</a>
  <ul class="collapse">
  <li><a href="#packages" id="toc-packages" class="nav-link" data-scroll-target="#packages">Packages</a></li>
  <li><a href="#packages-versions" id="toc-packages-versions" class="nav-link" data-scroll-target="#packages-versions">Packages Versions</a></li>
  <li><a href="#overview-of-the-gamlss.ggplots-package" id="toc-overview-of-the-gamlss.ggplots-package" class="nav-link" data-scroll-target="#overview-of-the-gamlss.ggplots-package">Overview of the <code>gamlss.ggplots</code> Package</a></li>
  <li><a href="#the-model" id="toc-the-model" class="nav-link" data-scroll-target="#the-model">The model</a></li>
  <li><a href="#sec-Family" id="toc-sec-Family" class="nav-link" data-scroll-target="#sec-Family">Distribution Families</a></li>
  <li><a href="#sec-Fitting" id="toc-sec-Fitting" class="nav-link" data-scroll-target="#sec-Fitting">Fitting different model</a></li>
  <li><a href="#residuals" id="toc-residuals" class="nav-link" data-scroll-target="#residuals">Residuals</a></li>
  <li><a href="#responce" id="toc-responce" class="nav-link" data-scroll-target="#responce">Responce</a></li>
  <li><a href="#fitted" id="toc-fitted" class="nav-link" data-scroll-target="#fitted">Fitted</a></li>
  <li><a href="#models" id="toc-models" class="nav-link" data-scroll-target="#models">Models</a></li>
  <li><a href="#bucket-plots" id="toc-bucket-plots" class="nav-link" data-scroll-target="#bucket-plots">Bucket plots</a></li>
  <li><a href="#plots-for-y-vectors" id="toc-plots-for-y-vectors" class="nav-link" data-scroll-target="#plots-for-y-vectors">Plots for <span class="math inline">\(y\)</span> vectors</a></li>
  <li><a href="#partial-effects" id="toc-partial-effects" class="nav-link" data-scroll-target="#partial-effects">Partial effects</a></li>
  <li><a href="#interpretation" id="toc-interpretation" class="nav-link" data-scroll-target="#interpretation">interpretation</a></li>
  <li><a href="#prediction" id="toc-prediction" class="nav-link" data-scroll-target="#prediction">prediction</a></li>
  <li><a href="#centile-estimation-utilities" id="toc-centile-estimation-utilities" class="nav-link" data-scroll-target="#centile-estimation-utilities">Centile estimation (Utilities)</a></li>
  <li><a href="#sec-Boostrapping" id="toc-sec-Boostrapping" class="nav-link" data-scroll-target="#sec-Boostrapping">Boostrapping</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">The Functions in <code>gamlss.ggplots</code></h1>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Authors</div>
  <div class="quarto-title-meta-heading">Affiliations</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author">De Bastiani, F. </p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            Federal University of Pernambuco, Brazil
          </p>
      </div>
    <div class="quarto-title-meta-contents">
    <p class="author">Heller, G. </p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            University of Syndey, Austalia
          </p>
      </div>
    <div class="quarto-title-meta-contents">
    <p class="author">Kneib, T. </p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            University of Gottigan, Gernany
          </p>
      </div>
    <div class="quarto-title-meta-contents">
    <p class="author">Mayr, A. </p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            University of Marburg, Gernany
          </p>
      </div>
    <div class="quarto-title-meta-contents">
    <p class="author">Julian Merder </p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            University of Marburg, Gernany
          </p>
      </div>
    <div class="quarto-title-meta-contents">
    <p class="author">Rigby, R. A. </p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            University of Greenwich, UK
          </p>
      </div>
    <div class="quarto-title-meta-contents">
    <p class="author">Stasinopoulos, M. D. <a href="mailto:d.stasinopoulos@gre.ac.uk" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> </p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            University of Greenwich, UK
          </p>
      </div>
    <div class="quarto-title-meta-contents">
    <p class="author">Stauffer, Reto </p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            University of Innsbruck, Austria
          </p>
      </div>
    <div class="quarto-title-meta-contents">
    <p class="author">Umlauf, N, </p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            University of Innsbruck, Austria
          </p>
      </div>
    <div class="quarto-title-meta-contents">
    <p class="author">Zeileis, A. </p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            University of Innsbruck, Austria
          </p>
      </div>
  </div>

<div class="quarto-title-meta">

      
  
    
  </div>
  


</header>


<section id="sec-introduction" class="level1">
<h1>Introduction</h1>
<section id="packages" class="level2">
<h2 class="anchored" data-anchor-id="packages">Packages</h2>
<p>This booklet provides an overview of the R package <code>gamlss.ggplots</code> and its functions, focusing on their use and the output they generate.</p>
<p>The <code>gamlss.ggplots</code> package offers a set of <code>ggplot2</code>-based visual tools for diagnostic and exploratory plots specifically tailored for models fitted using <code>gamlss()</code> and <code>gamlss2()</code>. Most of the functions in this package are compatible with both model types, making them broadly useful across the Generalized Additive Models for Location, Scale and Shape framework.</p>
<p>Supported Model Objects</p>
<ul>
<li><code>gamlss</code> — the original modeling interface for GAMLSS</li>
<li><code>gamlss2</code> — a modern interface with cleaner formula syntax and streamlined model handling</li>
</ul>
</section>
<section id="packages-versions" class="level2">
<h2 class="anchored" data-anchor-id="packages-versions">Packages Versions</h2>
<p>The latest versions of the key packages are:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co">#getRversion()</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gamlss)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gamlss2)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gamlss.ggplots)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"dplyr"</span>) </span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">packageVersion</span>(<span class="st">"gamlss"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] '5.4.23'</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">packageVersion</span>(<span class="st">"gamlss2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] '0.1.0'</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">packageVersion</span>(<span class="st">"gamlss.ggplots"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] '2.1.17'</code></pre>
</div>
</div>
</section>
<section id="overview-of-the-gamlss.ggplots-package" class="level2">
<h2 class="anchored" data-anchor-id="overview-of-the-gamlss.ggplots-package">Overview of the <code>gamlss.ggplots</code> Package</h2>
<p>Originally, the package <code>gamlss.ggplots</code> included all the functionality currently split between <code>gamlss.ggplots</code> and <code>gamlss.prepdata</code>. Due to maintenance challenges caused by the growing size and complexity of the package, it was divided into two separate components:</p>
<pre><code>- `gamlss.ggplots` — visualization and diagnostics

- `gamlss.prepdata` — data preparation utilities</code></pre>
<p>At this stage, <code>gamlss.ggplots</code> is experimental. Some functions are not yet exported (i.e., “hidden”) to allow for further testing and validation. These hidden functions can still be accessed using the triple-colon syntax:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>gamlss.ggplots<span class="sc">:::</span><span class="fu">function_name</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="function-categories" class="level3">
<h3 class="anchored" data-anchor-id="function-categories">Function Categories</h3>
<p>Functions in gamlss.ggplots can be broadly classified into three categories:</p>
<section id="before-fitting-a-model-functions" class="level4">
<h4 class="anchored" data-anchor-id="before-fitting-a-model-functions">1. Before-fitting a model functions</h4>
<p>Most if the before-fitting a model functions are moved to <code>gamlss.prepdata</code> package but few visualizing distribution families are remaining. Distribution relatated function names begin with <code>family_Name()</code> - Example: <code>family_pdf(NO)</code> which plots the density distribution from the Normal GAMLSS family.</p>
</section>
<section id="after-fitting-a-model-functions" class="level4">
<h4 class="anchored" data-anchor-id="after-fitting-a-model-functions">2. After-fitting a model functions</h4>
<p>These functions are used after a model has been fitted, providing diagnostics, interpretation aids, and predictions.</p>
<ol type="a">
<li><p><strong>Residual-based diagnostics</strong> - <code>resid_NAME()</code> – Diagnostics on residuals E.g., <code>resid_wp()</code> produces a worm plot for assessing the distribution.</p></li>
<li><p><strong>Fitted value</strong> visualizations - <code>fitted_NAME()</code> – Visualizes fitted parameters (<span class="math inline">\(\mu\)</span>, <span class="math inline">\(\sigma\)</span>, etc.) from a fitted model.</p></li>
<li><p><strong>Response</strong> variable plots <code>resp_NAME()</code> – Plots the response variable against various model-based quantities such as parameters or quantiles.</p></li>
<li><p>Model <strong>interpretation</strong></p></li>
</ol>
<ul>
<li><code>pe_NAME()</code> – Plots partial effects to aid model interpretation.</li>
<li><code>influence_NAME()</code> – Shows influence measures of model terms.</li>
<li><code>predict_NAME()</code> – Provides predictions, often using a newdata argument.</li>
</ul>
<ol start="5" type="a">
<li>Model <strong>comparison</strong> diagnostics
<ul>
<li><code>model_NAME()</code> – Functions for comparing multiple models, typically using diagnostic statistics or GAIC.</li>
</ul></li>
</ol>
</section>
<section id="utility-functions" class="level4">
<h4 class="anchored" data-anchor-id="utility-functions">3. Utility functions</h4>
<p>These functions serve as helpers for data exploration and bootstrap analyses.</p>
<ol type="a">
<li><p>Single-vector visualizations • y_NAME() – For example, y_hist(y) plots a histogram, y_acf(y) plots the autocorrelation function.</p></li>
<li><p>Bootstrap summaries • boot_NAME() – Plots parameter estimates or fitted values across bootstrap samples.</p></li>
<li><p>Function imitations</p></li>
</ol>
<p>Some utility functions imitate existing gamlss functions. E.g., <code>histSmo_plot()</code> mimics <code>histSmo()</code> but uses ggplot2.</p>
<p>Because the package is at an experimental stage, some of the functions are hidden to allowed time for checking. The hidden functions can be accessed using <code>gamlss.ggplots:::functionname()</code>.</p>
<p>Note future functions that are not included in the package at the moment are:</p>
<ul>
<li><p><code>ale_param()</code> for accumulated local effects of a specific term on the parameter (Mikis)</p></li>
<li><p><code>pd_param()</code> for partial dependants plots of a specific term on the parameter (Mikis)</p></li>
<li><p><code>pe_exceedance()</code> (Julian)</p></li>
</ul>
</section>
</section>
</section>
<section id="the-model" class="level2">
<h2 class="anchored" data-anchor-id="the-model">The model</h2>
<p>The general GAMLSS model can be written as <span id="eq-GAMLSS_ML"><span class="math display">\[
\begin{split}
y_i     &amp;  \stackrel{\small{ind}}{\sim }  \mathcal{D}( \theta_1, \ldots, \theta_k) \nonumber \\
g(\theta_1) &amp;= \mathcal{ML}_1(x_{1i},x_{2i}, \ldots,  x_{pi}) \nonumber \\
\ldots &amp;= \ldots \nonumber\\
g(\theta_k) &amp;= \mathcal{ML}_k(x_{1i},x_{2i}, \ldots,  x_{pi}).
\end{split}
  \tag{1}\]</span></span> When only <em>additive smoothing</em> terms are fitted the model can be written; <span id="eq-GAMLSS"><span class="math display">\[\begin{split}
y_i     &amp;  \stackrel{\small{ind}}{\sim }  \mathcal{D}( \theta_1, \ldots, \theta_k) \nonumber \\
g(\theta_1)  &amp;= b_0 + s_1(x_{1i})  +  \cdots,  +s_p(x_{pi}) \nonumber\\
\cdots &amp;=&amp; \cdots \nonumber\\
g(\theta_k)  &amp;= b_0 + s_1(x_{1i})  +   \cdots,  +s_p(x_{pi}).
\end{split}
\tag{2}\]</span></span></p>
</section>
<section id="sec-Family" class="level2">
<h2 class="anchored" data-anchor-id="sec-Family">Distribution Families</h2>
<p>Here there are no fitted models, and the only requirement are values for the parameters. Note that those function may at a later stage move to <code>gamlss.prepdata</code>.</p>
<section id="family_pdf" class="level3">
<h3 class="anchored" data-anchor-id="family_pdf"><code>family_pdf()</code></h3>
<p>The function <code>family_pdf()</code> plots individual pdf’s from <strong>gamlss.family</strong> distribution. It needs the family argument.</p>
<section id="continuous" class="level4">
<h4 class="anchored" data-anchor-id="continuous">Continuous</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">family_pdf</span>(NO, <span class="at">from=</span><span class="sc">-</span><span class="dv">5</span>,<span class="at">to=</span><span class="dv">5</span>, <span class="at">mu=</span><span class="dv">0</span>, <span class="at">sigma=</span><span class="fu">c</span>(.<span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-fam_pdf_continuous" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fam_pdf_continuous-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="gamlss-ggplots_files/figure-html/fig-fam_pdf_continuous-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fam_pdf_continuous-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Continuous response example: plotting the pdf of a normal random variable.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="discrere-counts" class="level4">
<h4 class="anchored" data-anchor-id="discrere-counts">Discrere counts</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">family_pdf</span>(NBI, <span class="at">to=</span><span class="dv">15</span>, <span class="at">mu=</span><span class="dv">1</span>, <span class="at">sigma=</span><span class="fu">c</span>(.<span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">alpha=</span>.<span class="dv">9</span>, <span class="at">size.seqment =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-fam_pdf_discrete" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fam_pdf_discrete-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="gamlss-ggplots_files/figure-html/fig-fam_pdf_discrete-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fam_pdf_discrete-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Count response example: plotting the pdf of a beta binomial.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="discrere-binomial-type" class="level4">
<h4 class="anchored" data-anchor-id="discrere-binomial-type">Discrere binomial type</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">family_pdf</span>(BB, <span class="at">to=</span><span class="dv">15</span>, <span class="at">mu=</span>.<span class="dv">5</span>, <span class="at">sigma=</span><span class="fu">c</span>(.<span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">2</span>),  <span class="at">alpha=</span>.<span class="dv">9</span>, , <span class="at">size.seqment =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-fam_pdf_binomial" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fam_pdf_binomial-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="gamlss-ggplots_files/figure-html/fig-fam_pdf_binomial-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fam_pdf_binomial-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Beta binomial response example: plotting the pdf of a beta binomial.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="family_cdf" class="level3">
<h3 class="anchored" data-anchor-id="family_cdf"><code>family_cdf</code></h3>
<p>The function plots individual cdf’s from <strong>gamlss.family</strong> distribution. It needs the family argument.</p>
<section id="continuous-1" class="level4">
<h4 class="anchored" data-anchor-id="continuous-1">Continuous</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">family_cdf</span>(NO, <span class="at">from=</span><span class="sc">-</span><span class="dv">5</span>,<span class="at">to=</span><span class="dv">5</span>, <span class="at">mu=</span><span class="dv">0</span>, <span class="at">sigma=</span><span class="fu">c</span>(.<span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-fam_cdf_continuous" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fam_cdf_continuous-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="gamlss-ggplots_files/figure-html/fig-fam_cdf_continuous-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fam_cdf_continuous-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: Continuous response example: plotting the cdf of a normal random variable.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="discrere-counts-1" class="level4">
<h4 class="anchored" data-anchor-id="discrere-counts-1">Discrere counts</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">family_cdf</span>(NBI, <span class="at">to=</span><span class="dv">15</span>, <span class="at">mu=</span><span class="dv">1</span>, <span class="at">sigma=</span><span class="fu">c</span>(.<span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">alpha=</span>.<span class="dv">9</span>, <span class="at">size.seqment =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-fam_cdf_discrete" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fam_cdf_discrete-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="gamlss-ggplots_files/figure-html/fig-fam_cdf_discrete-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fam_cdf_discrete-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5: Count response example: plotting the cdf of a negative binomial.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="discrere-binomial-type-1" class="level4">
<h4 class="anchored" data-anchor-id="discrere-binomial-type-1">Discrere binomial type</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">family_cdf</span>(BB, <span class="at">to=</span><span class="dv">15</span>, <span class="at">mu=</span>.<span class="dv">5</span>, <span class="at">sigma=</span><span class="fu">c</span>(.<span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">2</span>),  <span class="at">alpha=</span>.<span class="dv">9</span>, , <span class="at">size.seqment =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-fam_cdf_binomial" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fam_cdf_binomial-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="gamlss-ggplots_files/figure-html/fig-fam_cdf_binomial-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fam_cdf_binomial-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6: Count response example: plotting the cdf of a beta binomial.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="family_cor" class="level3">
<h3 class="anchored" data-anchor-id="family_cor"><code>family_cor()</code></h3>
<p>The function <code>family_cor()</code> provides a crude way of checking the inter correlation of parameters within any <code>gamlss.family</code> distribution. It</p>
<ul>
<li><p>generates 10000 values from the specified distribution,</p></li>
<li><p>fits the distribution to the generared data and</p></li>
<li><p>plots the correlation coefficients of the parameters.</p></li>
</ul>
<p>Those correlation coefficients are taken from the fitted variance covariance matrix.</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>The method only provides an idea of how the correlations between parameters are at specified points of the distribution parameters. At different parameter points the distribution could behave completely different.</p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co">#source("~/Dropbox/github/gamlss-ggplots/R/family_cor.R")</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>gamlss.ggplots<span class="sc">:::</span><span class="fu">family_cor</span>(<span class="st">"BCTo"</span>, <span class="at">mu=</span><span class="dv">1</span>, <span class="at">sigma=</span><span class="fl">0.11</span>, <span class="at">nu=</span><span class="dv">1</span>, <span class="at">tau=</span><span class="dv">5</span>, <span class="at">no.sim=</span><span class="dv">10000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-fam_correlation" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fam_correlation-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="gamlss-ggplots_files/figure-html/fig-fam_correlation-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fam_correlation-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7: Family correlation of a BCTo distribution at specified values of the parameters.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="sec-Fitting" class="level2">
<h2 class="anchored" data-anchor-id="sec-Fitting">Fitting different model</h2>
<p>First we fit different GAMLSS models. The models will to be used for demonstration later.</p>
<section id="the-null-model-using-normal-distribution." class="level4">
<h4 class="anchored" data-anchor-id="the-null-model-using-normal-distribution.">The <code>null</code> model using Normal distribution.</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(rent)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Null model </span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>m0<span class="ot">&lt;-</span><span class="fu">gamlss</span>(R<span class="sc">~</span><span class="dv">1</span>,<span class="at">family=</span>GA,<span class="at">data=</span>rent)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>GAMLSS-RS iteration 1: Global Deviance = 28611.58 
GAMLSS-RS iteration 2: Global Deviance = 28611.58 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>g0<span class="ot">&lt;-</span><span class="fu">gamlss2</span>(R<span class="sc">~</span><span class="dv">1</span>,<span class="at">family=</span>GA,<span class="at">data=</span>rent)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>GAMLSS-RS iteration  1: Global Deviance = 28611.5819 eps = 0.056387     
GAMLSS-RS iteration  2: Global Deviance = 28611.5819 eps = 0.000000     </code></pre>
</div>
</div>
</section>
<section id="additive-smooth-model-using-normal-distribution." class="level4">
<h4 class="anchored" data-anchor-id="additive-smooth-model-using-normal-distribution.">Additive smooth model using Normal distribution.</h4>
<p>Fit additive smooth terms for <code>Fl</code> and <code>A</code> in the <span class="math inline">\(\mu\)</span> using the Normal distribution.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Smooth terms for Fl  and A  in mu, normal</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>m1<span class="ot">&lt;-</span><span class="fu">gamlss</span>(R<span class="sc">~</span><span class="fu">pb</span>(Fl)<span class="sc">+</span><span class="fu">pb</span>(A),<span class="at">family=</span>NO,<span class="at">data=</span>rent)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>GAMLSS-RS iteration 1: Global Deviance = 28264.19 
GAMLSS-RS iteration 2: Global Deviance = 28264.19 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>g1<span class="ot">&lt;-</span><span class="fu">gamlss2</span>(R<span class="sc">~</span><span class="fu">s</span>(Fl)<span class="sc">+</span><span class="fu">s</span>(A),<span class="at">family=</span>NO,<span class="at">data=</span>rent)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>GAMLSS-RS iteration  1: Global Deviance = 28269.3496 eps = 0.024145     
GAMLSS-RS iteration  2: Global Deviance = 28265.5187 eps = 0.000135     
GAMLSS-RS iteration  3: Global Deviance = 28265.5116 eps = 0.000000     </code></pre>
</div>
</div>
<p>Fit additive smooth terms for <code>Fl</code> and <code>A</code> and main effects for <code>H</code> and <code>loc</code> in the <span class="math inline">\(\mu\)</span> using the Normal distribution.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>m2<span class="ot">&lt;-</span><span class="fu">gamlss</span>(R<span class="sc">~</span><span class="fu">pb</span>(Fl)<span class="sc">+</span><span class="fu">pb</span>(A)<span class="sc">+</span>H<span class="sc">+</span>loc, <span class="at">family=</span>NO, <span class="at">data=</span>rent)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>GAMLSS-RS iteration 1: Global Deviance = 28062.62 
GAMLSS-RS iteration 2: Global Deviance = 28062.62 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>g2<span class="ot">&lt;-</span><span class="fu">gamlss2</span>(R<span class="sc">~</span><span class="fu">s</span>(Fl)<span class="sc">+</span><span class="fu">s</span>(A)<span class="sc">+</span>H<span class="sc">+</span>loc, <span class="at">family=</span>NO, <span class="at">data=</span>rent)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>GAMLSS-RS iteration  1: Global Deviance = 28067.7199 eps = 0.031106     
GAMLSS-RS iteration  2: Global Deviance = 28063.5704 eps = 0.000147     
GAMLSS-RS iteration  3: Global Deviance = 28063.5654 eps = 0.000000     </code></pre>
</div>
</div>
</section>
<section id="additive-smooth-model-using-gamma-distribution." class="level4">
<h4 class="anchored" data-anchor-id="additive-smooth-model-using-gamma-distribution.">Additive smooth model using gamma distribution.</h4>
<p>Fit additive smooth terms for <code>Fl</code> and <code>A</code> and main effects for <code>H</code> and <code>loc</code> in the <span class="math inline">\(\mu\)</span> using Gamma distribution.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Smooth terms for Fl  and A main effects for H and loc in mu, gamma</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>m3<span class="ot">&lt;-</span><span class="fu">gamlss</span>(R<span class="sc">~</span><span class="fu">pb</span>(Fl)<span class="sc">+</span><span class="fu">pb</span>(A)<span class="sc">+</span>H<span class="sc">+</span>loc,<span class="at">family=</span>GA,<span class="at">data=</span>rent)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>GAMLSS-RS iteration 1: Global Deviance = 27683.22 
GAMLSS-RS iteration 2: Global Deviance = 27683.22 
GAMLSS-RS iteration 3: Global Deviance = 27683.22 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>g3<span class="ot">&lt;-</span><span class="fu">gamlss2</span>(R<span class="sc">~</span><span class="fu">s</span>(Fl)<span class="sc">+</span><span class="fu">s</span>(A)<span class="sc">+</span>H<span class="sc">+</span>loc,<span class="at">family=</span>GA,<span class="at">data=</span>rent)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>GAMLSS-RS iteration  1: Global Deviance = 27693.1246 eps = 0.086677     
GAMLSS-RS iteration  2: Global Deviance = 27686.3102 eps = 0.000246     
GAMLSS-RS iteration  3: Global Deviance = 27686.309 eps = 0.000000     </code></pre>
</div>
</div>
<p>Fit additive smooth terms for <code>Fl</code> and <code>A</code> and main effects for <code>H</code> and <code>loc</code> in both <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span> parameters using Gamma distribution.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>m4<span class="ot">&lt;-</span><span class="fu">gamlss</span>(R<span class="sc">~</span><span class="fu">pb</span>(Fl)<span class="sc">+</span><span class="fu">pb</span>(A)<span class="sc">+</span>H<span class="sc">+</span>loc, <span class="at">sigma.fo=</span><span class="sc">~</span><span class="fu">pb</span>(Fl)<span class="sc">+</span><span class="fu">pb</span>(A)<span class="sc">+</span>H<span class="sc">+</span>loc, </span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">family=</span>GA,<span class="at">data=</span>rent)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>GAMLSS-RS iteration 1: Global Deviance = 27572.14 
GAMLSS-RS iteration 2: Global Deviance = 27570.29 
GAMLSS-RS iteration 3: Global Deviance = 27570.28 
GAMLSS-RS iteration 4: Global Deviance = 27570.28 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>g4<span class="ot">&lt;-</span><span class="fu">gamlss2</span>(R<span class="sc">~</span><span class="fu">s</span>(Fl)<span class="sc">+</span><span class="fu">s</span>(A)<span class="sc">+</span>H<span class="sc">+</span>loc, <span class="at">sigma.fo=</span><span class="sc">~</span><span class="fu">s</span>(Fl)<span class="sc">+</span><span class="fu">s</span>(A)<span class="sc">+</span>H<span class="sc">+</span>loc, </span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">family=</span>GA,<span class="at">data=</span>rent)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>GAMLSS-RS iteration  1: Global Deviance = 27621.6847 eps = 0.089033     
GAMLSS-RS iteration  2: Global Deviance = 27613.1786 eps = 0.000307     
GAMLSS-RS iteration  3: Global Deviance = 27613.1728 eps = 0.000000     </code></pre>
</div>
</div>
</section>
<section id="additive-smooth-model-using-s-and-the-gamma-distribution." class="level4">
<h4 class="anchored" data-anchor-id="additive-smooth-model-using-s-and-the-gamma-distribution.">Additive smooth model using <code>s()</code> and the gamma distribution.</h4>
<p>We bring the package <em>gamlss.add</em> for extra smoothers</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gamlss.add)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Fit interaction smooth terms for <code>Fl</code> and <code>A</code> in <span class="math inline">\(\mu\)</span>, additive main smooth effect for for <code>Fl</code> and <code>A</code> in <span class="math inline">\(\sigma\)</span> and main effects for <code>H</code> and <code>loc</code> in both <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span> using a gamma family.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>m5<span class="ot">&lt;-</span><span class="fu">gamlss</span>(R<span class="sc">~</span><span class="fu">ga</span>(<span class="sc">~</span><span class="fu">s</span>(Fl, A))<span class="sc">+</span>H<span class="sc">+</span>loc, <span class="at">sigma.fo=</span><span class="sc">~</span><span class="fu">pb</span>(Fl)<span class="sc">+</span><span class="fu">pb</span>(A)<span class="sc">+</span>H<span class="sc">+</span>loc, </span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">family=</span>GA,<span class="at">data=</span>rent)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>GAMLSS-RS iteration 1: Global Deviance = 27542.45 
GAMLSS-RS iteration 2: Global Deviance = 27537.5 
GAMLSS-RS iteration 3: Global Deviance = 27537.41 
GAMLSS-RS iteration 4: Global Deviance = 27537.41 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>g5<span class="ot">&lt;-</span><span class="fu">gamlss2</span>(R<span class="sc">~</span><span class="fu">s</span>(Fl, A)<span class="sc">+</span>H<span class="sc">+</span>loc, <span class="at">sigma.fo=</span><span class="sc">~</span><span class="fu">s</span>(Fl)<span class="sc">+</span><span class="fu">s</span>(A)<span class="sc">+</span>H<span class="sc">+</span>loc, </span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">family=</span>GA,<span class="at">data=</span>rent)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>GAMLSS-RS iteration  1: Global Deviance = 27654.2449 eps = 0.087960     
GAMLSS-RS iteration  2: Global Deviance = 27584.1109 eps = 0.002536     
GAMLSS-RS iteration  3: Global Deviance = 27584.0985 eps = 0.000000     </code></pre>
</div>
</div>
<p>Fit interaction smooth terms for <code>Fl</code> and <code>A</code>, interaction for <code>H</code> and <code>loc</code> in <span class="math inline">\(\mu\)</span> and and main effects only in <span class="math inline">\(\sigma\)</span> using a gamma family.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>m6<span class="ot">&lt;-</span><span class="fu">gamlss</span>(R<span class="sc">~</span><span class="fu">ga</span>(<span class="sc">~</span><span class="fu">s</span>(Fl, A))<span class="sc">+</span>H<span class="sc">*</span>loc, <span class="at">sigma.fo=</span><span class="sc">~</span><span class="fu">pb</span>(Fl)<span class="sc">+</span><span class="fu">pb</span>(A)<span class="sc">+</span>H<span class="sc">+</span>loc, </span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">family=</span>GA,<span class="at">data=</span>rent)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>GAMLSS-RS iteration 1: Global Deviance = 27541.97 
GAMLSS-RS iteration 2: Global Deviance = 27536.41 
GAMLSS-RS iteration 3: Global Deviance = 27536.29 
GAMLSS-RS iteration 4: Global Deviance = 27536.29 
GAMLSS-RS iteration 5: Global Deviance = 27536.29 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>g6<span class="ot">&lt;-</span><span class="fu">gamlss2</span>(R<span class="sc">~</span><span class="fu">s</span>(Fl, A)<span class="sc">+</span>H<span class="sc">*</span>loc, <span class="at">sigma.fo=</span><span class="sc">~</span><span class="fu">s</span>(Fl)<span class="sc">+</span><span class="fu">s</span>(A)<span class="sc">+</span>H<span class="sc">+</span>loc, </span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">family=</span>GA,<span class="at">data=</span>rent)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>GAMLSS-RS iteration  1: Global Deviance = 27654.5301 eps = 0.087950     
GAMLSS-RS iteration  2: Global Deviance = 27583.6533 eps = 0.002562     
GAMLSS-RS iteration  3: Global Deviance = 27583.6377 eps = 0.000000     </code></pre>
</div>
</div>
<p>Fit a penalised varying coefficient model (a simpler form of smoothing in two dimensions that <code>s(Fl, A)</code>) in <span class="math inline">\(\mu\)</span>. Additive main smooth effect for for <code>Fl</code> and <code>A</code> in <span class="math inline">\(\sigma\)</span> and main effects for <code>H</code> and <code>loc</code> in both <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span> using a gamma family.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>m7<span class="ot">&lt;-</span><span class="fu">gamlss</span>(R<span class="sc">~</span><span class="fu">pvc</span>(Fl, <span class="at">by=</span>A)<span class="sc">+</span>H<span class="sc">+</span>loc, <span class="at">sigma.fo=</span><span class="sc">~</span><span class="fu">pb</span>(Fl)<span class="sc">+</span><span class="fu">pb</span>(A)<span class="sc">+</span>H<span class="sc">+</span>loc, </span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">family=</span>GA,<span class="at">data=</span>rent)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>GAMLSS-RS iteration 1: Global Deviance = 28221.47 
GAMLSS-RS iteration 2: Global Deviance = 28203.83 
GAMLSS-RS iteration 3: Global Deviance = 28201.49 
GAMLSS-RS iteration 4: Global Deviance = 28201.05 
GAMLSS-RS iteration 5: Global Deviance = 28200.94 
GAMLSS-RS iteration 6: Global Deviance = 28200.92 
GAMLSS-RS iteration 7: Global Deviance = 28200.91 
GAMLSS-RS iteration 8: Global Deviance = 28200.9 
GAMLSS-RS iteration 9: Global Deviance = 28200.9 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>g7<span class="ot">&lt;-</span><span class="fu">gamlss2</span>(R<span class="sc">~</span><span class="fu">s</span>(Fl,<span class="at">by=</span>A)<span class="sc">+</span>H<span class="sc">+</span>loc, <span class="at">sigma.fo=</span><span class="sc">~</span><span class="fu">s</span>(Fl)<span class="sc">+</span><span class="fu">s</span>(A)<span class="sc">+</span>H<span class="sc">+</span>loc, </span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">family=</span>GA,<span class="at">data=</span>rent)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>GAMLSS-RS iteration  1: Global Deviance = 27732.5053 eps = 0.085379     
GAMLSS-RS iteration  2: Global Deviance = 27731.6923 eps = 0.000029     
GAMLSS-RS iteration  3: Global Deviance = 27731.6805 eps = 0.000000     </code></pre>
</div>
</div>
</section>
<section id="neural-network-using-gamma-distribution" class="level4">
<h4 class="anchored" data-anchor-id="neural-network-using-gamma-distribution">Neural network using Gamma distribution</h4>
<p>Fit Neural networks for <code>Fl</code>, <code>A</code>, <code>H</code>, and <code>loc</code> for both <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span> # gamma family</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>m8<span class="ot">&lt;-</span><span class="fu">gamlss</span>(R<span class="sc">~</span><span class="fu">nn</span>(<span class="sc">~</span>Fl<span class="sc">+</span>A<span class="sc">+</span>H<span class="sc">+</span>loc,   <span class="at">size =</span> <span class="dv">10</span>,</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">decay =</span> <span class="fl">0.01</span>,  <span class="at">maxit =</span> <span class="dv">100</span>), </span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">sigma.fo=</span><span class="sc">~</span><span class="fu">nn</span>(<span class="sc">~</span>Fl<span class="sc">+</span>A<span class="sc">+</span>H<span class="sc">+</span>loc, <span class="at">decay =</span> <span class="fl">0.01</span>), </span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">family=</span>GA,<span class="at">data=</span>rent)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>GAMLSS-RS iteration 1: Global Deviance = 27574.91 
GAMLSS-RS iteration 2: Global Deviance = 27473.94 
GAMLSS-RS iteration 3: Global Deviance = 27471.27 
GAMLSS-RS iteration 4: Global Deviance = 27471.27 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>g8<span class="ot">&lt;-</span><span class="fu">gamlss2</span>(R<span class="sc">~</span><span class="fu">n</span>(<span class="sc">~</span>Fl<span class="sc">+</span>A<span class="sc">+</span>H<span class="sc">+</span>loc,   <span class="at">size =</span> <span class="dv">10</span>, <span class="at">decay =</span> <span class="fl">0.01</span>), </span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">sigma.fo=</span><span class="sc">~</span><span class="fu">n</span>(<span class="sc">~</span>Fl<span class="sc">+</span>A<span class="sc">+</span>H<span class="sc">+</span>loc, <span class="at">size =</span> <span class="dv">3</span>,<span class="at">decay =</span> <span class="fl">0.01</span>), </span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">family=</span>GA,<span class="at">data=</span>rent)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>GAMLSS-RS iteration  1: Global Deviance = 27451.1239 eps = 0.094659     
GAMLSS-RS iteration  2: Global Deviance = 27419.8177 eps = 0.001140     
GAMLSS-RS iteration  3: Global Deviance = 27419.4945 eps = 0.000011     
GAMLSS-RS iteration  4: Global Deviance = 27419.4945 eps = 0.000000     </code></pre>
</div>
</div>
</section>
<section id="regression-trees-fits-using-gamma-distribution" class="level4">
<h4 class="anchored" data-anchor-id="regression-trees-fits-using-gamma-distribution">Regression trees fits using Gamma distribution</h4>
<p>Fit regression trees for <code>Fl</code>, <code>A</code>, <code>H</code>, and <code>loc</code> for both <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>m9<span class="ot">&lt;-</span><span class="fu">gamlss</span>(R<span class="sc">~</span><span class="fu">tr</span>(<span class="sc">~</span>Fl<span class="sc">+</span>A<span class="sc">+</span>H<span class="sc">+</span>loc), </span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">sigma.fo=</span><span class="sc">~</span><span class="fu">tr</span>(<span class="sc">~</span>Fl<span class="sc">+</span>A<span class="sc">+</span>H<span class="sc">+</span>loc), </span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">family=</span>GA,<span class="at">data=</span>rent)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>GAMLSS-RS iteration 1: Global Deviance = 27779.77 
GAMLSS-RS iteration 2: Global Deviance = 27754.62 
GAMLSS-RS iteration 3: Global Deviance = 27754.53 
GAMLSS-RS iteration 4: Global Deviance = 27754.53 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>g9<span class="ot">&lt;-</span><span class="fu">gamlss2</span>(R<span class="sc">~</span><span class="fu">tr</span>(<span class="sc">~</span>Fl<span class="sc">+</span>A<span class="sc">+</span>H<span class="sc">+</span>loc), </span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">sigma.fo=</span><span class="sc">~</span><span class="fu">tr</span>(<span class="sc">~</span>Fl<span class="sc">+</span>A<span class="sc">+</span>H<span class="sc">+</span>loc), </span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">family=</span>GA,<span class="at">data=</span>rent)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>GAMLSS-RS iteration  1: Global Deviance = 27759.7778 eps = 0.084479     
GAMLSS-RS iteration  2: Global Deviance = 27755.0828 eps = 0.000169     
GAMLSS-RS iteration  3: Global Deviance = 27755.0817 eps = 0.000000     </code></pre>
</div>
</div>
<p>Checking the models using different GAIC. The <em>best</em> model using AIC is <code>m5</code> while using BIC is <code>m4</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>T1 <span class="ot">&lt;-</span> <span class="fu">GAIC.table</span>(m1,m2,m3,m4,m5,m6,m7, m8, m9)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>minimum GAIC(k= 2 ) model: m5 
minimum GAIC(k= 3.84 ) model: m4 
minimum GAIC(k= 7.59 ) model: m4 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>T1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          df      k=2   k=3.84   k=7.59
m1  8.372701 28280.94 28296.34 28327.74
m2 11.748554 28086.12 28107.74 28151.79
m3 11.215475 27705.65 27726.29 27768.34
m4 22.250355 27614.78 27655.72 27739.16
m5 33.146682 27603.70 27664.69 27788.99
m6 35.262213 27606.81 27671.70 27803.93
m7 21.380016 28243.66 28283.00 28363.18
m8 95.000000 27661.27 27836.07 28192.32
m9 18.000000 27790.53 27823.65 27891.15</code></pre>
</div>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model_GAIC</span>(m1,m2,m3,m4,m5,m6,m7, m8, m9)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="gamlss-ggplots_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p><code>GAIC.table</code> is not working for <code>gamlss2</code> objects</p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># T2 &lt;- GAIC.table(g1,g2,g3,g4,g5,g6,g7, g8, g9)</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="co"># T2</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="fu">model_GAIC</span>(g1,g2,g3,g4,g5,g6,g7, g8, g9)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="gamlss-ggplots_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="residuals" class="level2">
<h2 class="anchored" data-anchor-id="residuals">Residuals</h2>
<p>This section describes plots to do with the residuals of a single GAMLSS fitted model. Plotting, the residuals is very important, because if the model is correct, the residuals of the model should be like a white noise. In GAMLSS we use the (randomised) normalised residuals. Randomisation happens only if the distribution is discreet, or if it is censored. Normalisation means that if the model is correct or adequate, then the residuals should look like a normal distribution.</p>
<section id="resid_index" class="level3">
<h3 class="anchored" data-anchor-id="resid_index"><code>resid_index()</code></h3>
<p>By plotting, the residual against the data index we would expect that there is no pattern in the plot because of the assumption that the observations (given the explanatory variables) are independent. <a href="#fig-resid_index" class="quarto-xref">Figure&nbsp;8</a> show the standard residual plot against the index of the data. The argument <code>value</code> has to do with the <em>outliers</em> hoghlighted in the plot and can be change to a higher cut-off point. Other type of residuals, suitable standardised, not necessarily GAMLSS model residuals, can be plotted by using the argument <code>resid</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>gg <span class="ot">&lt;-</span><span class="fu">resid_index</span>(g4)</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>gg</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-resid_index" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-resid_index-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="gamlss-ggplots_files/figure-html/fig-resid_index-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-resid_index-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8: Residual plot.
</figcaption>
</figure>
</div>
</div>
</div>
<section id="different-models" class="level4">
<h4 class="anchored" data-anchor-id="different-models">Different models</h4>
<p>Residual plots from different models can be plotted in different graphs see <a href="#fig-figure2" class="quarto-xref">Figure&nbsp;9</a>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>g11 <span class="ot">&lt;-</span><span class="fu">resid_index</span>(g1)</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>g12 <span class="ot">&lt;-</span><span class="fu">resid_index</span>(g2)</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>g13 <span class="ot">&lt;-</span><span class="fu">resid_index</span>(g3)</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>g14 <span class="ot">&lt;-</span><span class="fu">resid_index</span>(g4)</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(g11,g12,g13,g14 )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-figure2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-figure2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="gamlss-ggplots_files/figure-html/fig-figure2-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-figure2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9: Residual plot.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="different-range-of-an-x-variable" class="level4">
<h4 class="anchored" data-anchor-id="different-range-of-an-x-variable">Different range of an x-variable</h4>
<p>Here the residual plot is split against one continuous explanatory variables <code>Fl</code> using the function <code>facet_wrap()</code>. The function splits in three different cut points because the <code>cut_number(rent\$Fl, 3)</code> is used. Note that in order for <code>facet_wrap()</code> to work we had to suppress the horizontal likes using the argument <code>no.lines=TRUE</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">resid_index</span>(g1, <span class="at">no.lines=</span><span class="cn">TRUE</span>)<span class="sc">+</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">facet_wrap</span>(<span class="sc">~</span><span class="fu">cut_number</span>(rent<span class="sc">$</span>Fl, <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-figure1113" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-figure1113-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="gamlss-ggplots_files/figure-html/fig-figure1113-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-figure1113-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10: Resisduals plot against the x-variable split in tree sections.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Here we split according to one continuous an one categorical x-variables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">resid_index</span>(g1, <span class="at">no.lines=</span><span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="fu">cut_number</span>(rent<span class="sc">$</span>Fl, <span class="dv">3</span>)<span class="sc">~</span>rent<span class="sc">$</span>loc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-figure11131" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-figure11131-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="gamlss-ggplots_files/figure-html/fig-figure11131-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-figure11131-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;11: Residuals plot against two x-variable split in tree sections.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="resid_mu" class="level3">
<h3 class="anchored" data-anchor-id="resid_mu"><code>resid_mu()</code></h3>
<p>A plot of the residual against the fitted values of the model, usually reveals whether there is a heterogeneity in the data. The <code>resid_mu()</code> plots the residual from model <code>m1</code> against the fitted values for the model for <span class="math inline">\(\mu\)</span>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">resid_mu</span>(g1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-figure1111" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-figure1111-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="gamlss-ggplots_files/figure-html/fig-figure1111-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-figure1111-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12: Residuals plot against the fitted values for models <code>m1</code>
</figcaption>
</figure>
</div>
</div>
</div>
<p>We can observe a fan type of behaviour in the plot, that is the residuals are become bigger for larger fitted values of the response. This behaviour is typical for models with heterogeneity in the data. Remember <code>m1</code> does not have a model for <span class="math inline">\(\sigma\)</span>. In model <code>m4</code> we fit an mode for <span class="math inline">\(\sigma\)</span> so the residuals are better.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">resid_mu</span>(g4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-figure11111" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-figure11111-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="gamlss-ggplots_files/figure-html/fig-figure11111-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-figure11111-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13: Residuals plot against the fitted values for models <code>m4</code>
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="resid_quantile" class="level3">
<h3 class="anchored" data-anchor-id="resid_quantile"><code>resid_quantile()</code></h3>
<p>Residual plots from model <code>m1</code> against the fitted quantile (including the median) values can be obtained using:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">resid_quantile</span>(g4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="gamlss-ggplots_files/figure-html/figure1111_quantile-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Residuals plot against the fitted 50 percent fitted quantiles of model <code>m4</code></figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="resid_xvar" class="level3">
<h3 class="anchored" data-anchor-id="resid_xvar"><code>resid_xvar()</code></h3>
<section id="against-a-continuous-explanatory-variable" class="level4">
<h4 class="anchored" data-anchor-id="against-a-continuous-explanatory-variable">Against a continuous explanatory variable</h4>
<p>Residual plots against a continuous explanatory variables can be plotted using: <code>resid_xvar()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">resid_xvar</span>(g1,Fl)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="gamlss-ggplots_files/figure-html/figure1112-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Resisduals plot against the x-variables</figcaption>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">resid_xvar</span>(g1,A)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="gamlss-ggplots_files/figure-html/figure1112-2.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Resisduals plot against the x-variables</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="against-a-categorical-explanatory-variable" class="level4">
<h4 class="anchored" data-anchor-id="against-a-categorical-explanatory-variable">Against a categorical explanatory variable</h4>
<p>The function is working differently for categorical x-variables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">resid_xvar</span>(g1,H)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="gamlss-ggplots_files/figure-html/figure11121-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Resisduals plot against categorical x-variables for model <code>m1</code></figcaption>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">resid_xvar</span>(g1,loc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="gamlss-ggplots_files/figure-html/figure11121-2.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Resisduals plot against categorical x-variables for model <code>m1</code></figcaption>
</figure>
</div>
</div>
</div>
<p>Or for a different models:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">resid_xvar</span>(g4,loc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="gamlss-ggplots_files/figure-html/figure11122-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Resisduals plot against categorical x-variables for model <code>m4</code></figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="resid_qqplot" class="level3">
<h3 class="anchored" data-anchor-id="resid_qqplot"><code>resid_qqplot()</code></h3>
<p>The function <code>resid_qqplot()</code> can be use to get a QQ-plot of the residuals.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>gg <span class="ot">&lt;-</span><span class="fu">resid_qqplot</span>(g1)</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>gg</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-figure2_1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-figure2_1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="gamlss-ggplots_files/figure-html/fig-figure2_1-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-figure2_1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;14: QQ-plot for model <code>m1</code>
</figcaption>
</figure>
</div>
</div>
</div>
<p>The plot appears in <a href="#fig-figure2_1" class="quarto-xref">Figure&nbsp;14</a>.</p>
<p>For comparing two different models you can use</p>
<p>To add another model QQ-plot try</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p><code>add_resid_qqplot</code> is not working for extra <code>gamlss2</code> objects</p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>gg1 <span class="ot">&lt;-</span><span class="fu">add_resid_qqplot</span>(gg, m4)</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="co">#gg1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>or alternatively you can use the function <code>model_qqplot()</code> which can display more than two models.</p>
<section id="for-different-values-of-x-variables" class="level4">
<h4 class="anchored" data-anchor-id="for-different-values-of-x-variables">For different values of x-variables</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>gg<span class="sc">+</span><span class="fu">facet_grid</span>(<span class="fu">cut_number</span>(rent<span class="sc">$</span>Fl, <span class="dv">3</span>)<span class="sc">~</span>rent<span class="sc">$</span>loc)<span class="sc">+</span> </span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"qqplot of model m1 against Fl and A"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-figure211" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-figure211-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="gamlss-ggplots_files/figure-html/fig-figure211-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-figure211-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;15: QQ-plot of the residuals of model <code>m1</code> against <code>Fl</code> and `A’
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>gg1<span class="sc">+</span><span class="fu">facet_grid</span>(<span class="fu">cut_number</span>(rent<span class="sc">$</span>Fl, <span class="dv">3</span>)<span class="sc">~</span>rent<span class="sc">$</span>loc)<span class="sc">+</span> </span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"qqplot of models m1 and m4 against Fl and A"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-figure211_1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-figure211_1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="gamlss-ggplots_files/figure-html/fig-figure211_1-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-figure211_1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16: QQ-plot of the residuals of models <code>m1</code> and <code>m4</code> against <code>Fl</code> and `A’
</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="resid_wp-worm-plots" class="level3">
<h3 class="anchored" data-anchor-id="resid_wp-worm-plots"><code>resid_wp()</code>, Worm plots</h3>
<p>The worm plot for a single model can be plotted using:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>gg<span class="ot">&lt;-</span><span class="fu">resid_wp</span>(g4)</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>gg</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-figure3_a" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-figure3_a-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="gamlss-ggplots_files/figure-html/fig-figure3_a-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-figure3_a-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;17: Worm-plot of the residuals for model <code>m4</code>
</figcaption>
</figure>
</div>
</div>
</div>
<p>See <a href="#fig-figure3_a" class="quarto-xref">Figure&nbsp;17</a>.</p>
<section id="resid_wp_wrap" class="level4">
<h4 class="anchored" data-anchor-id="resid_wp_wrap"><code>resid_wp_wrap()</code></h4>
<p>The worm plot for a single model at different values of an explanatory variable can be plotted using:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>gg1 <span class="ot">&lt;-</span><span class="fu">resid_wp_wrap</span>(g4, <span class="at">xvar=</span>rent<span class="sc">$</span>A)</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>gg1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-figure3_b" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-figure3_b-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="gamlss-ggplots_files/figure-html/fig-figure3_b-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-figure3_b-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;18: Worm-plot of the residuals for model <code>m4</code> at different values of <code>A</code>
</figcaption>
</figure>
</div>
</div>
</div>
<p>See <a href="#fig-figure3_b" class="quarto-xref">Figure&nbsp;18</a></p>
</section>
</section>
<section id="resid_density" class="level3">
<h3 class="anchored" data-anchor-id="resid_density"><code>resid_density()</code></h3>
<section id="the-single-density" class="level4">
<h4 class="anchored" data-anchor-id="the-single-density">The single density</h4>
<p>The function <code>resid_density()</code> plots the density of the residuals for one model while the function <code>model_densitity()</code> for more than one model.</p>
<p>Here we plot the density of the residuals for model <code>m4</code>. See Figure <a href="#fig-figure4" class="quarto-xref">Figure&nbsp;19</a> for the plot.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>gg<span class="ot">&lt;-</span><span class="fu">resid_density</span>(g4)</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>gg</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-figure4" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-figure4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="gamlss-ggplots_files/figure-html/fig-figure4-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-figure4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;19: A density plot of the residuals
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="the-multiple-densities" class="level4">
<h4 class="anchored" data-anchor-id="the-multiple-densities">The multiple densities</h4>
<p>Here we plot the density of the residuals for model <code>m4</code> against two explanatory variables, <code>Fl</code> and <code>A</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>gg<span class="sc">+</span><span class="fu">facet_grid</span>(<span class="fu">cut_number</span>(rent<span class="sc">$</span>Fl, <span class="dv">3</span>)<span class="sc">~</span>rent<span class="sc">$</span>loc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-figure41" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-figure41-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="gamlss-ggplots_files/figure-html/fig-figure41-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-figure41-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;20: A density plot of the residuals against <code>Fl</code> and <code>A</code>
</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="resid_ecdf" class="level3">
<h3 class="anchored" data-anchor-id="resid_ecdf"><code>resid_ecdf()</code></h3>
<p>Figure <a href="#fig-figure7" class="quarto-xref">Figure&nbsp;21</a> show the empirical cumulative distribution function of the residuals of model <code>m4</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>gg <span class="ot">&lt;-</span> <span class="fu">resid_ecdf</span>(g4)</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>gg</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-figure7" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-figure7-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="gamlss-ggplots_files/figure-html/fig-figure7-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-figure7-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;21: The ECDF of the residuals.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Below cdf of a normally distributed variable with <span class="math inline">\(\mu=0\)</span> and <span class="math inline">\(\sigma=1\)</span> is added to the previous plot.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>gg<span class="sc">+</span><span class="fu">stat_function</span>(<span class="at">fun =</span> pNO, <span class="at">args=</span><span class="fu">list</span>(<span class="at">mu=</span><span class="dv">0</span>, <span class="at">sigma=</span><span class="dv">1</span>), <span class="at">col=</span><span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-figure71" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-figure71-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="gamlss-ggplots_files/figure-html/fig-figure71-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-figure71-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;22: The ECDF of the residuals with added normal distribution.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="resid_dtop" class="level3">
<h3 class="anchored" data-anchor-id="resid_dtop"><code>resid_dtop()</code></h3>
<p>The function <code>resid_dtop()</code> plot a de-trended empirical cdf plot. See <a href="#fig-figure6" class="quarto-xref">Figure&nbsp;23</a> for the plot.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>gg<span class="ot">&lt;-</span><span class="fu">resid_dtop</span>(g4)</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>gg</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-figure6" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-figure6-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="gamlss-ggplots_files/figure-html/fig-figure6-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-figure6-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;23: A detrended Own’s plot.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="resid_plots" class="level3">
<h3 class="anchored" data-anchor-id="resid_plots"><code>resid_plots()</code></h3>
<p>The function <code>resid_plots()</code> tries to imitate the function <code>plot.gamlss()</code> of the <strong>gamlss</strong> package.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">resid_plots</span>(g4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-figure80" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-figure80-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="gamlss-ggplots_files/figure-html/fig-figure80-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-figure80-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;24: The plot of residuals.
</figcaption>
</figure>
</div>
</div>
</div>
<section id="different-themes" class="level4">
<h4 class="anchored" data-anchor-id="different-themes">Different themes</h4>
<p>There are also different themes in the plot. Next in Figure <a href="#fig-figure81" class="quarto-xref">Figure&nbsp;25</a> we are trying <code>theme="new"</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">resid_plots</span>(g4, <span class="at">theme=</span><span class="st">"new"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-figure81" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-figure81-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="gamlss-ggplots_files/figure-html/fig-figure81-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-figure81-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;25: The plot of residuals with `theme=new’.
</figcaption>
</figure>
</div>
</div>
</div>
<p><a href="#fig-figure82" class="quarto-xref">Figure&nbsp;26</a> has <code>theme="ecdf"</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">resid_plots</span>(g4, <span class="at">theme=</span><span class="st">"ecdf"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-figure82" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-figure82-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="gamlss-ggplots_files/figure-html/fig-figure82-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-figure82-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;26: The plot of residuals with `theme=ecdf’.
</figcaption>
</figure>
</div>
</div>
</div>
<p><a href="#fig-figure83" class="quarto-xref">Figure&nbsp;27</a> has <code>theme="ecdf"</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">resid_plots</span>(g4, <span class="at">theme=</span><span class="st">"ts"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-figure83" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-figure83-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="gamlss-ggplots_files/figure-html/fig-figure83-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-figure83-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;27: The plot of residuals with `theme=ts’.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="resid_symmetry" class="level3">
<h3 class="anchored" data-anchor-id="resid_symmetry"><code>resid_symmetry()</code></h3>
<p>A symmetry plot is useful for detecting asymmetry (skewnwess) in the residuals. Here we plot the symmetry plot of the residuals for model <code>m4</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>gg<span class="ot">&lt;-</span><span class="fu">resid_symmetry</span>(g4)</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>gg</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-figure4_1_1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-figure4_1_1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="gamlss-ggplots_files/figure-html/fig-figure4_1_1-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-figure4_1_1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;28: A symmetry plot of the residuals.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="responce" class="level2">
<h2 class="anchored" data-anchor-id="responce">Responce</h2>
<section id="sec-respmu" class="level3">
<h3 class="anchored" data-anchor-id="sec-respmu"><code>resp_mu()</code></h3>
<p>Plotting, the response variable against the fitted values is a traditional way of checking the adequacy of the model in linear regression model situation. The closer the points of the plot to 45% line the better the model. Also a hight correlation coeficient indicates a good fit. For GAMLSS this is equivalent of plotting the response against the fitted values of the <span class="math inline">\(\mu\)</span> model. A strong linear pattern indicates that the <span class="math inline">\(\mu\)</span> model is adequate.</p>
<p><a href="#fig-figure_resp_1" class="quarto-xref">Figure&nbsp;29</a> plots the response variable against the fitted values for <span class="math inline">\(\mu\)</span>. The plot also show the 45 degrees line between the two variables. The relation should be close to linear as possible. The correlation between the response and the fitted values for <span class="math inline">\(\mu\)</span> is 0.6154328, -0.1275195 which is reasonable hight.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">resp_mu</span>(g4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-figure_resp_1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-figure_resp_1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="gamlss-ggplots_files/figure-html/fig-figure_resp_1-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-figure_resp_1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;29: Response against the <code>mu</code> fitted values.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="resp_param" class="level3">
<h3 class="anchored" data-anchor-id="resp_param"><code>resp_param()</code></h3>
<p>GAMLSS have more than one parameters, so plotting the response variable against the the other parameters fitted values could be of interest. The function <code>resp_param()</code> can do that. It plots the response against any parameter fitted values. <a href="#fig-resp_param_sigma" class="quarto-xref">Figure&nbsp;30</a> shows the response against the fitted values for <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span> respectively for model <code>g4</code>. The first plot has the usual interpretation describes in Section <a href="#sec-respmu" class="quarto-xref">Section&nbsp;1.8.1</a> the second need more thought.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">resp_param</span>(g4)</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a><span class="co"># resp_param(g4, "sigma")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-resp_param_sigma" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-resp_param_sigma-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="gamlss-ggplots_files/figure-html/fig-resp_param_sigma-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-resp_param_sigma-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;30: Residuals plot against the fitted <code>mu</code> and <code>sigma</code>, respectively, for model `g4’
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="resp_quantile" class="level3">
<h3 class="anchored" data-anchor-id="resp_quantile"><code>resp_quantile</code></h3>
<p>The function <code>resp_quantile</code> plots the response variable against any fitted quantile. Here we plot the respose against the 0.95 quantile. Again the interpretation needs more thought.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">resp_quantile</span>(g4, <span class="at">quantile=</span><span class="fl">0.95</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-figure_resp_3" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-figure_resp_3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="gamlss-ggplots_files/figure-html/fig-figure_resp_3-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-figure_resp_3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;31: The respose against the fitted median.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="fitted" class="level2">
<h2 class="anchored" data-anchor-id="fitted">Fitted</h2>
<section id="fitted_devianceincr" class="level3">
<h3 class="anchored" data-anchor-id="fitted_devianceincr"><code>fitted_devianceIncr()</code></h3>
<p>The function<code>fitted_devianceIncr()</code> plots the deviance increment from a fitted <code>gamlss</code> model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fitted_devianceIncr</span>(g4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-fitted_devianceIncr" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fitted_devianceIncr-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="gamlss-ggplots_files/figure-html/fig-fitted_devianceIncr-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fitted_devianceIncr-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;32: Plotting deviance increment from a fitted GAMLSS model.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="fitted_leverage" class="level3">
<h3 class="anchored" data-anchor-id="fitted_leverage"><code>fitted_leverage()</code></h3>
<p>The function plots the linear leverage from a fitted GAMLSS model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fitted_leverage</span>(m4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1969 observations with 5 variables </code></pre>
</div>
<div class="cell-output-display">
<div id="fig-fitted_leverage" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fitted_leverage-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="gamlss-ggplots_files/figure-html/fig-fitted_leverage-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fitted_leverage-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;33: Plotting linear leverage from a fitted GAMLSS model.
</figcaption>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p><code>fitted_leverage</code> is not working for <code>gamlss2</code> objects</p>
</div>
</div>
</section>
<section id="fitted_pdf" class="level3">
<h3 class="anchored" data-anchor-id="fitted_pdf"><code>fitted_pdf()</code></h3>
<p>The function <code>fitted_pdf()</code> plots individual pdf’s from a fitted model. It needs the argument <code>obs</code> indicating which observation number to plot.</p>
<p>First a continuous distribution:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>a1 <span class="ot">&lt;-</span> <span class="fu">gamlss2</span>(y<span class="sc">~</span><span class="fu">pb</span>(x),<span class="at">sigma.fo=</span><span class="sc">~</span>x, <span class="at">data=</span>abdom, <span class="at">family=</span>LO)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>GAMLSS-RS iteration  1: Global Deviance = 4884.1282 eps = 0.342686     
GAMLSS-RS iteration  2: Global Deviance = 4778.7262 eps = 0.021580     
GAMLSS-RS iteration  3: Global Deviance = 4778.6342 eps = 0.000019     
GAMLSS-RS iteration  4: Global Deviance = 4778.6342 eps = 0.000000     </code></pre>
</div>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fitted_pdf</span>(a1, <span class="at">obs=</span><span class="fu">c</span>(<span class="dv">500</span>,<span class="dv">610</span>),<span class="at">from=</span><span class="dv">280</span>, <span class="at">to=</span><span class="dv">500</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-fitted_pdf_1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fitted_pdf_1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="gamlss-ggplots_files/figure-html/fig-fitted_pdf_1-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fitted_pdf_1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;34: Probability functions for a continuous responses.
</figcaption>
</figure>
</div>
</div>
</div>
<p>For a infinite count response:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">gamlss2</span>(y<span class="sc">~</span><span class="fu">pb</span>(x)<span class="sc">+</span>qrt, <span class="at">data=</span>aids, <span class="at">family=</span>NBI) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>GAMLSS-RS iteration  1: Global Deviance = 366.3831 eps = 0.366850     
GAMLSS-RS iteration  2: Global Deviance = 359.6389 eps = 0.018407     
GAMLSS-RS iteration  3: Global Deviance = 359.6228 eps = 0.000044     
GAMLSS-RS iteration  4: Global Deviance = 359.6228 eps = 0.000000     </code></pre>
</div>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fitted_pdf</span>(p1, <span class="at">obs=</span><span class="dv">10</span><span class="sc">:</span><span class="dv">15</span>, <span class="at">from=</span><span class="dv">25</span>, <span class="at">to=</span><span class="dv">130</span>, <span class="at">alpha=</span>.<span class="dv">9</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-fitted_pdf_count" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fitted_pdf_count-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="gamlss-ggplots_files/figure-html/fig-fitted_pdf_count-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fitted_pdf_count-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;35: Probability functions for a count responses.
</figcaption>
</figure>
</div>
</div>
</div>
<p>This is a binomial example:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>h <span class="ot">&lt;-</span> <span class="fu">gamlss</span>(y<span class="sc">~</span>ward<span class="sc">+</span>loglos<span class="sc">+</span>year, <span class="sc">~</span>year<span class="sc">+</span>ward, <span class="at">family=</span>BB, <span class="at">data=</span>aep)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>GAMLSS-RS iteration 1: Global Deviance = 4490.361 
GAMLSS-RS iteration 2: Global Deviance = 4483.13 
GAMLSS-RS iteration 3: Global Deviance = 4483.021 
GAMLSS-RS iteration 4: Global Deviance = 4483.02 
GAMLSS-RS iteration 5: Global Deviance = 4483.02 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fitted_pdf</span>(h, <span class="at">obs=</span><span class="fu">c</span>(<span class="dv">10</span><span class="sc">:</span><span class="dv">15</span>), <span class="at">alpha=</span>.<span class="dv">9</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-fitted_pdf_binom" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fitted_pdf_binom-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="gamlss-ggplots_files/figure-html/fig-fitted_pdf_binom-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fitted_pdf_binom-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;36: Probability functions for a binomial responses.
</figcaption>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p><code>binomial type distributions</code> are not working for <code>gamlss2</code> objects</p>
</div>
</div>
</section>
<section id="fitted_cdf" class="level3">
<h3 class="anchored" data-anchor-id="fitted_cdf"><code>fitted_cdf()</code></h3>
<p>The function <code>fitted_cdf()</code> plots individual pdf’s from a fitted model. It needs the argument <code>obs</code> indicating which observation number to plot. %</p>
<p>First a continuous distribution:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fitted_cdf</span>(a1, <span class="at">obs=</span><span class="fu">c</span>(<span class="dv">500</span>,<span class="dv">610</span>),<span class="at">from=</span><span class="dv">280</span>, <span class="at">to=</span><span class="dv">500</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-fitted_cdf" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fitted_cdf-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="gamlss-ggplots_files/figure-html/fig-fitted_cdf-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fitted_cdf-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;37: Probability functions for a continuous responses.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Here is a count response data example</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fitted_cdf</span>(p1, <span class="at">obs=</span><span class="dv">10</span><span class="sc">:</span><span class="dv">15</span>, <span class="at">from=</span><span class="dv">25</span>, <span class="at">to=</span><span class="dv">130</span>, <span class="at">alpha=</span>.<span class="dv">9</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-fitted_cdf_count" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fitted_cdf_count-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="gamlss-ggplots_files/figure-html/fig-fitted_cdf_count-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fitted_cdf_count-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;38: Probability functions for a count responses.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Here is a binomial response data example</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>h<span class="ot">&lt;-</span><span class="fu">gamlss</span>(y<span class="sc">~</span>ward<span class="sc">+</span>loglos<span class="sc">+</span>year, <span class="at">sigma.formula=</span><span class="sc">~</span>year<span class="sc">+</span>ward, <span class="at">family=</span>BB, <span class="at">data=</span>aep)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>GAMLSS-RS iteration 1: Global Deviance = 4490.361 
GAMLSS-RS iteration 2: Global Deviance = 4483.13 
GAMLSS-RS iteration 3: Global Deviance = 4483.021 
GAMLSS-RS iteration 4: Global Deviance = 4483.02 
GAMLSS-RS iteration 5: Global Deviance = 4483.02 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fitted_cdf</span>(h, <span class="at">obs=</span><span class="fu">c</span>(<span class="dv">10</span><span class="sc">:</span><span class="dv">15</span>),  <span class="at">alpha=</span>.<span class="dv">9</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-fitted_cdf_binomial" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fitted_cdf_binomial-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="gamlss-ggplots_files/figure-html/fig-fitted_cdf_binomial-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fitted_cdf_binomial-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;39: Probability functions for a binomial responses.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="fitted_cdf_data" class="level3">
<h3 class="anchored" data-anchor-id="fitted_cdf_data"><code>fitted_cdf_data()</code></h3>
<p>The function <code>fitted_cdf_data()</code> plots individual pdf’s from a fitted model but also add the data points. It needs the argument <code>obs</code> indicating which obs</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fitted_cdf_data</span>(a1, <span class="at">obs=</span><span class="fu">c</span>(<span class="dv">500</span>,<span class="dv">610</span>),<span class="at">from=</span><span class="dv">280</span>, <span class="at">to=</span><span class="dv">500</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-fitted_cdf_data" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fitted_cdf_data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="gamlss-ggplots_files/figure-html/fig-fitted_cdf_data-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fitted_cdf_data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;40: Probability functions for a binomial responses.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="sec-fittedcentiles0" class="level3">
<h3 class="anchored" data-anchor-id="sec-fittedcentiles0"><code>fitted_centiles()</code></h3>
<p>See Section <a href="#sec-fittedcentiles" class="quarto-xref">Section&nbsp;1.16.2</a>.</p>
</section>
</section>
<section id="models" class="level2">
<h2 class="anchored" data-anchor-id="models">Models</h2>
<section id="model_gaic" class="level3">
<h3 class="anchored" data-anchor-id="model_gaic"><code>model_GAIC()</code></h3>
<p>The functions <code>model_GAIC()</code> and <code>model_GAIC_lollipop()</code> are identical but the appearance is different.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>gg<span class="ot">&lt;-</span><span class="fu">model_GAIC</span>(g0,g1,g2,g3,g4, g5,g6,g7,g8,g9)</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>gg</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-figure9" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-figure9-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="gamlss-ggplots_files/figure-html/fig-figure9-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-figure9-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;41: plotting the GAIC.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="model_gaic_lollipop" class="level3">
<h3 class="anchored" data-anchor-id="model_gaic_lollipop"><code>model_GAIC_lollipop()</code></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>gg1<span class="ot">&lt;-</span><span class="fu">model_GAIC_lollipop</span>(g0,g1,g2,g3,g4, g5,g6,g7,g8,g9)</span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>gg1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-figure9_1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-figure9_1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="gamlss-ggplots_files/figure-html/fig-figure9_1-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-figure9_1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;42: plotting the GAIC.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="model_density" class="level3">
<h3 class="anchored" data-anchor-id="model_density"><code>model_density()</code></h3>
<p>To plot the residuals densities of all <code>m1</code>, <code>m2</code>, <code>m3</code>, and <code>m4</code> models use:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>gg <span class="ot">&lt;-</span>  <span class="fu">model_density</span>(g1, g2, g3, g4)</span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>gg</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="gamlss-ggplots_files/figure-html/figure5-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>A density plot of the residuals from different models.</figcaption>
</figure>
</div>
</div>
</div>
<p>For multiple plots use:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>gg<span class="sc">+</span><span class="fu">facet_grid</span>(<span class="fu">cut_number</span>(rent<span class="sc">$</span>Fl, <span class="dv">3</span>)<span class="sc">~</span>rent<span class="sc">$</span>loc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="gamlss-ggplots_files/figure-html/figure5_b-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>A density plot of the residuals from different models.</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="model_qqplot" class="level3">
<h3 class="anchored" data-anchor-id="model_qqplot"><code>model_qqplot()</code></h3>
<p>The function <code>model_qqplot()</code> can be use to get a QQ-plots for more that one fitted model residuals.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>gg <span class="ot">&lt;-</span> <span class="fu">model_qqplot</span>(g1, g2, g3, g4)</span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>gg</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-figure21A" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-figure21A-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="gamlss-ggplots_files/figure-html/fig-figure21A-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-figure21A-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;43: QQ-plot of the residuals of models <code>m1</code>, <code>m2</code>, <code>m3</code> and <code>m4</code>.
</figcaption>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>something is wrong here <code>g2</code> and <code>g3</code> are not appearing</p>
</div>
</div>
<p>For multiple plots use;</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>gg<span class="sc">+</span><span class="fu">facet_grid</span>(<span class="fu">cut_number</span>(rent<span class="sc">$</span>Fl, <span class="dv">3</span>)<span class="sc">~</span>rent<span class="sc">$</span>loc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-figure21B" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-figure21B-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="gamlss-ggplots_files/figure-html/fig-figure21B-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-figure21B-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;44: Multiple QQ-plots of the residuals of models <code>m1</code>, <code>m2</code>, <code>m3</code> and <code>m4</code>.
</figcaption>
</figure>
</div>
</div>
</div>
<p>The resulting plot is shown on the <a href="#fig-figure21B" class="quarto-xref">Figure&nbsp;44</a>.</p>
</section>
<section id="model_wp" class="level3">
<h3 class="anchored" data-anchor-id="model_wp"><code>model_wp()</code></h3>
<p>The function <code>model_wp()</code> can be use to get a worm-plots for multiple fitted models residuals.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>gg <span class="ot">&lt;-</span> <span class="fu">model_wp</span>(g1, g2, g3, g4)</span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>gg</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-figure21ZIBIA" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-figure21ZIBIA-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="gamlss-ggplots_files/figure-html/fig-figure21ZIBIA-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-figure21ZIBIA-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;45: Worm-plot of the residuals of models <code>m1</code>, <code>m2</code>, <code>m3</code> and <code>m4</code>.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="model_wp_wrap" class="level3">
<h3 class="anchored" data-anchor-id="model_wp_wrap"><code>model_wp_wrap()</code></h3>
<p>For model worm plots at differenbt values of the explnatory variables use;</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>gg1 <span class="ot">&lt;-</span> <span class="fu">model_wp_wrap</span>(g1, g2, g3, g4, <span class="at">xvar=</span>rent<span class="sc">$</span>A)</span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>gg1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-figure21ZIBIB" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-figure21ZIBIB-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="gamlss-ggplots_files/figure-html/fig-figure21ZIBIB-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-figure21ZIBIB-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;46: Multiple worm-plot of the residuals of models <code>m1</code>, <code>m2</code>, <code>m3</code> and <code>m4</code>.
</figcaption>
</figure>
</div>
</div>
</div>
<p>The resulting plot is shown on the right side of Figure <a href="#fig-figure21ZIBIB" class="quarto-xref">Figure&nbsp;46</a>.</p>
</section>
</section>
<section id="bucket-plots" class="level2">
<h2 class="anchored" data-anchor-id="bucket-plots">Bucket plots</h2>
<section id="moment_bucket-and-model_mom_bucket" class="level3">
<h3 class="anchored" data-anchor-id="moment_bucket-and-model_mom_bucket"><code>moment_bucket()</code> and <code>model_mom_bucket()</code></h3>
<p>The function <code>model_mom_bucket()</code> can be use to get the moment bucket plot for one or more fitted model residuals. Note that <code>moment_bucket()</code> is synonymous to <code>model_mom_bucket()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>gg <span class="ot">&lt;-</span> <span class="fu">moment_bucket</span>(g1, g2, g3, g4)</span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>gg</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-figure21_BC" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-figure21_BC-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="gamlss-ggplots_files/figure-html/fig-figure21_BC-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-figure21_BC-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;47: Single moment bucket plots of the residuals of models <code>m1</code>, <code>m2</code>, <code>m3</code> and <code>m4</code>.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="moment_bucket_wrap" class="level3">
<h3 class="anchored" data-anchor-id="moment_bucket_wrap"><code>moment_bucket_wrap()</code></h3>
<p>For multiple plots use</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>gg1 <span class="ot">&lt;-</span> <span class="fu">moment_bucket_wrap</span>(m1, m2, m3, m4, <span class="at">xvar=</span>rent<span class="sc">$</span>A)</span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>gg1 </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-figure21_BD" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-figure21_BD-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="gamlss-ggplots_files/figure-html/fig-figure21_BD-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-figure21_BD-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;48: Multiple moment bucket plots of the residuals of models <code>g1</code>, <code>g2</code>, <code>g3</code> and <code>g4</code>.
</figcaption>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>Not working with <code>gamlls2</code> objects</p>
</div>
</div>
<p>The resulting plot is shown on the right side of Figure <a href="#fig-figure21_BD" class="quarto-xref">Figure&nbsp;48</a>.</p>
</section>
<section id="moment_gray_both-and-moment_colour_both" class="level3">
<h3 class="anchored" data-anchor-id="moment_gray_both-and-moment_colour_both"><code>moment_gray_both()</code> and <code>moment_colour_both()</code></h3>
<p>Note that the background of the bucket plots is generated by the functions</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="fu">moment_gray_both</span>()</span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a><span class="fu">moment_colour_both</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-figure21_BCA-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-figure21_BCA-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="gamlss-ggplots_files/figure-html/fig-figure21_BCA-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-figure21_BCA-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;49: The background of the moment bucket plot.
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display">
<div id="fig-figure21_BCA-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-figure21_BCA-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="gamlss-ggplots_files/figure-html/fig-figure21_BCA-2.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-figure21_BCA-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;50: The background of the moment bucket plot.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="model_devianceincr_diff" class="level3">
<h3 class="anchored" data-anchor-id="model_devianceincr_diff"><code>model_devianceIncr_diff()</code></h3>
<p>The function plots the difference in deviance increment between two fitted <code>gamlss</code> models.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model_devianceIncr_diff</span>(m3,m4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-model_devianceIncr_diff" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-model_devianceIncr_diff-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="gamlss-ggplots_files/figure-html/fig-model_devianceIncr_diff-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-model_devianceIncr_diff-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;51: Deviance difference between models <code>m3</code> and <code>m4</code>.
</figcaption>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>Not working with <code>gamlls2</code> objects</p>
</div>
</div>
</section>
<section id="model_pca" class="level3">
<h3 class="anchored" data-anchor-id="model_pca"><code>model_pca()</code></h3>
<p>This function it uses Principal Component Analysis (PCA) for the residual of multiple models and plots a bi-plot the first and second components.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>gg <span class="ot">&lt;-</span> <span class="fu">model_pca</span>(g1,g2,g3,g4)</span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>gg</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-model_pca" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-model_pca-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="gamlss-ggplots_files/figure-html/fig-model_pca-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-model_pca-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;52: A PCA of different models residuals`.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="sec-modelcentiles0" class="level3">
<h3 class="anchored" data-anchor-id="sec-modelcentiles0"><code>model_centiles()</code></h3>
<p>See Section <a href="#sec-modelcentiles" class="quarto-xref">Section&nbsp;1.16.4</a>.</p>
</section>
</section>
<section id="plots-for-y-vectors" class="level2">
<h2 class="anchored" data-anchor-id="plots-for-y-vectors">Plots for <span class="math inline">\(y\)</span> vectors</h2>
<section id="y_hist" class="level3">
<h3 class="anchored" data-anchor-id="y_hist"><code>y_hist()</code></h3>
<p>Here we generate a vector from a <code>BCCG</code> distribution and plot its histogram and its density function .</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rBCCG</span>(<span class="dv">1000</span>, <span class="at">mu=</span><span class="dv">3</span>, <span class="at">sigma=</span>.<span class="dv">1</span>, <span class="at">nu=</span><span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>gg <span class="ot">&lt;-</span> <span class="fu">y_hist</span>(y)</span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a>gg</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-y_hist" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-y_hist-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="gamlss-ggplots_files/figure-html/fig-y_hist-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-y_hist-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;53: Plotting a histogram of single variable and its density function.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Here we add the true pdf of the generated variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a>gg <span class="sc">+</span> <span class="fu">stat_function</span>(<span class="at">fun =</span> dBCT, <span class="at">args=</span><span class="fu">list</span>(<span class="at">mu=</span><span class="dv">3</span>, <span class="at">sigma=</span>.<span class="dv">1</span>,  <span class="at">nu=</span><span class="sc">-</span><span class="dv">1</span>, <span class="at">tau=</span><span class="dv">5</span>),</span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">geom =</span> <span class="st">"area"</span>, <span class="at">alpha=</span><span class="fl">0.5</span>, <span class="at">fill=</span><span class="st">"lightblue"</span>, <span class="at">color=</span><span class="st">"black"</span>, <span class="at">n=</span><span class="dv">301</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-hist_added" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-hist_added-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="gamlss-ggplots_files/figure-html/fig-hist_added-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-hist_added-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;54: Plotting a histogram of single variable and the <code>true</code> distribution supperimpose
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="y_dots" class="level3">
<h3 class="anchored" data-anchor-id="y_dots"><code>y_dots()</code></h3>
<p>The dots function is appropriate for long tail distributions be cause emphasise the the long left ot right tail of <span class="math inline">\(y\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rBCT</span>(<span class="dv">1000</span>, <span class="at">mu=</span><span class="dv">3</span>, <span class="at">sigma=</span>.<span class="dv">1</span>, <span class="at">nu=</span><span class="sc">-</span><span class="dv">1</span>, <span class="at">tau=</span><span class="dv">4</span>)</span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>gg <span class="ot">&lt;-</span> <span class="fu">y_dots</span>(y)</span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a>gg</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-y_dots" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-y_dots-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="gamlss-ggplots_files/figure-html/fig-y_dots-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-y_dots-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;55: Plotting the <span class="math inline">\(y\)</span> in dots to emphisise the long right tail.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="y_ecdf" class="level3">
<h3 class="anchored" data-anchor-id="y_ecdf"><code>y_ecdf()</code></h3>
<p>The empirical cdf of a variables can be plotted using the function <code>y_ecdf()</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rBCT</span>(<span class="dv">1000</span>, <span class="at">mu=</span><span class="dv">3</span>, <span class="at">sigma=</span>.<span class="dv">1</span>, <span class="at">nu=</span><span class="sc">-</span><span class="dv">1</span>, <span class="at">tau=</span><span class="dv">4</span>)</span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a>gg <span class="ot">&lt;-</span> <span class="fu">y_ecdf</span>(y)</span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a>gg</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-y_ecdf" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-y_ecdf-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="gamlss-ggplots_files/figure-html/fig-y_ecdf-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-y_ecdf-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;56: Plotting the empirical cdf of a variable.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Here is how you can add the theoretical cdf.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a>gg<span class="sc">+</span> <span class="fu">stat_function</span>(<span class="at">fun =</span> </span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>          pBCT, <span class="at">args=</span><span class="fu">list</span>(<span class="at">mu=</span><span class="dv">3</span>, <span class="at">sigma=</span>.<span class="dv">1</span>,  <span class="at">nu=</span><span class="sc">-</span><span class="dv">1</span>, <span class="at">tau=</span><span class="dv">5</span>), </span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">color=</span><span class="st">"red"</span>, <span class="at">n=</span><span class="dv">301</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-y_ecdf_add" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-y_ecdf_add-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="gamlss-ggplots_files/figure-html/fig-y_ecdf_add-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-y_ecdf_add-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;57: Plotting the empirical cdf of a variable plues its theoretical cdf.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="y_acf" class="level3">
<h3 class="anchored" data-anchor-id="y_acf"><code>y_acf()</code></h3>
<p>The functions <code>y_acf()</code> take a single time series vector and plot its auto-correlation function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="fu">y_acf</span>(<span class="fu">diff</span>(EuStockMarkets[,<span class="dv">1</span>])) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-y_acf" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-y_acf-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="gamlss-ggplots_files/figure-html/fig-y_acf-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-y_acf-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;58: Plotting ACF of the first difference of FTSE.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="y_pacf" class="level3">
<h3 class="anchored" data-anchor-id="y_pacf"><code>y_pacf()</code></h3>
<p>The functions <code>y_pacf()</code> take a single time series vector and plot its partial auto-correlation function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="fu">y_pacf</span>(<span class="fu">diff</span>(EuStockMarkets[,<span class="dv">1</span>])) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-y_pacf" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-y_pacf-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="gamlss-ggplots_files/figure-html/fig-y_pacf-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-y_pacf-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;59: Plotting PACF of the first difference of FTSE.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="y_symmetry" class="level3">
<h3 class="anchored" data-anchor-id="y_symmetry"><code>y_symmetry()</code></h3>
<p>Here we plot the symmetry plot of the variable <span class="math inline">\(y\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a>gg<span class="ot">&lt;-</span><span class="fu">y_symmetry</span>(rent<span class="sc">$</span>R)</span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a>gg</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-y_symmetry" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-y_symmetry-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="gamlss-ggplots_files/figure-html/fig-y_symmetry-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-y_symmetry-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;60: A symmetry plot of the rent data.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="partial-effects" class="level2">
<h2 class="anchored" data-anchor-id="partial-effects">Partial effects</h2>
<p>Those functions should be called <code>fitted_pe\_\...</code> but we have dropped the <code>fitted</code> part to simplify the notation.</p>
<section id="pe_terms" class="level3">
<h3 class="anchored" data-anchor-id="pe_terms"><code>pe_terms()</code></h3>
<p>The function plots individual terms from a fitted <code>gamlss</code> model. It is equivalent to <code>term.plot()</code>. Note that the function will produce up to 9 term plots before ask for the next page.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a>gamlss.ggplots<span class="sc">:::</span><span class="fu">pe_terms</span>(m4, <span class="at">partial=</span>T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-pe_terms" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-pe_terms-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="gamlss-ggplots_files/figure-html/fig-pe_terms-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-pe_terms-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;61: Plotting terms from a fitted GAMLSS model.
</figcaption>
</figure>
</div>
</div>
</div>
<p>The function <code>pe_terms()</code> uses the function <code>lpred()</code> to obtain the partial fitted terms. The function <code>lpred()</code> is using the parameter <code>model.frame</code> which has already evaluate the factors as a set of dummy variables. The partial terms are then evaluated by fixing the other terms on their means and after subtraction for the mean of the response.</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>Not working with <code>gamlls2</code> objects</p>
</div>
</div>
</section>
</section>
<section id="interpretation" class="level2">
<h2 class="anchored" data-anchor-id="interpretation">interpretation</h2>
<section id="pe_param" class="level3">
<h3 class="anchored" data-anchor-id="pe_param"><code>pe_param()</code></h3>
<p>The function <code>pe_param()</code> plots the partial effect of one or two specified term(s) given all other terms in the model remain fixed at predetermined values. Depending on length of the argument <code>term</code> the function <code>pe_param()</code> uses the function <code>pe_1_param()</code> or <code>pe_2_param()</code> to plot the partial effects. Here we plot it against a continuous variable <code>A</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pe_param</span>(g4, <span class="st">"A"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-pe_param" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-pe_param-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="gamlss-ggplots_files/figure-html/fig-pe_param-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-pe_param-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;62: Plotting partial terms from <code>A</code>.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Here we plot it against a categorical variable <code>loc</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pe_param</span>(g4, <span class="st">"loc"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-pe_param_loc" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-pe_param_loc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="gamlss-ggplots_files/figure-html/fig-pe_param_loc-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-pe_param_loc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;63: Plotting partial terms from <code>loc</code>.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Here we use two continuous variables <code>A</code> and <code>Fl</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a>gamlss.ggplots<span class="sc">:::</span><span class="fu">pe_param</span>(g4, <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"Fl"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-pe_param_2_ConCont" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-pe_param_2_ConCont-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="gamlss-ggplots_files/figure-html/fig-pe_param_2_ConCont-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-pe_param_2_ConCont-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;64: Plotting partial terms from <code>A</code> and <code>Fl</code>.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Here we use two continuous variables <code>A</code> and <code>Fl</code> but with the argument <code>filled = TRUE</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a>gamlss.ggplots<span class="sc">:::</span><span class="fu">pe_param</span>(g4, <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"Fl"</span>), <span class="at">filled =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-pe_param_2_ConCont_1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-pe_param_2_ConCont_1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="gamlss-ggplots_files/figure-html/fig-pe_param_2_ConCont_1-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-pe_param_2_ConCont_1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;65: Plotting partial terms from <code>A</code> and <code>Fl</code>.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Here we use one continuous <code>A</code> and one categorical variables <code>loc</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a>gamlss.ggplots<span class="sc">:::</span><span class="fu">pe_param</span>(g4, <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"loc"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-pe_param_2_ConCat" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-pe_param_2_ConCat-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="gamlss-ggplots_files/figure-html/fig-pe_param_2_ConCat-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-pe_param_2_ConCat-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;66: Plotting partial terms from <code>loc</code> and <code>A</code>.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Here we use two categorical variables <code>H</code> and <code>loc</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a>gamlss.ggplots<span class="sc">:::</span><span class="fu">pe_param</span>(g4, <span class="fu">c</span>(<span class="st">"H"</span>, <span class="st">"loc"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-pe_param_2_CatCat" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-pe_param_2_CatCat-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="gamlss-ggplots_files/figure-html/fig-pe_param_2_CatCat-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-pe_param_2_CatCat-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;67: Plotting partial terms from <code>loc</code> and <code>H</code>.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="pe_param_grid" class="level3">
<h3 class="anchored" data-anchor-id="pe_param_grid"><code>pe_param_grid()</code></h3>
<p>The function <code>pe_param_grid()</code> show multiple plots of partial effects (main effect or first order interactions) given all other terms in the model remain fixed at predetermined values.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a>gamlss.ggplots<span class="sc">:::</span><span class="fu">pe_param_grid</span>(g5, <span class="fu">list</span>(<span class="fu">c</span>(<span class="st">"Fl"</span>, <span class="st">"A"</span>), <span class="fu">c</span>(<span class="st">"H"</span>, <span class="st">"loc"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-pe_param_grid_1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-pe_param_grid_1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="gamlss-ggplots_files/figure-html/fig-pe_param_grid_1-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-pe_param_grid_1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;68: Plotting partial terms from <code>loc</code> and <code>H</code>.
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a>gamlss.ggplots<span class="sc">:::</span><span class="fu">pe_param_grid</span>(g5, <span class="fu">list</span>(<span class="fu">c</span>(<span class="st">"Fl"</span>, <span class="st">"A"</span>), <span class="fu">c</span>(<span class="st">"H"</span>, <span class="st">"loc"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-pe_param_grid_2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-pe_param_grid_2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="gamlss-ggplots_files/figure-html/fig-pe_param_grid_2-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-pe_param_grid_2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;69: Plotting the partial effect of terms in model <code>m6</code>. Note that the plot on the left panel is a genuine first order interaction term fitted with a 2 dimensional smoother using the interface with the package <code>mgcv</code> while the plot on the right panel is created using the two factors <code>H</code> and <code>loc</code> is just a two dimensional plot of the two main effects for <code>H</code> and <code>loc</code> respectively, since no interaction was fitted for those two terms
</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="prediction" class="level2">
<h2 class="anchored" data-anchor-id="prediction">prediction</h2>
<section id="predict_pdf" class="level3">
<h3 class="anchored" data-anchor-id="predict_pdf"><code>predict_pdf()</code></h3>
<p>Now with <code>newdata</code> we use `predict_pdf’:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict_pdf</span>(a1, <span class="at">newdata=</span>abdom[<span class="fu">c</span>(<span class="dv">11</span>,<span class="dv">15</span>,<span class="dv">20</span>,<span class="dv">25</span>),], <span class="at">from=</span><span class="dv">38</span>, <span class="at">to=</span><span class="dv">130</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-predict_pdf" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-predict_pdf-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="gamlss-ggplots_files/figure-html/fig-predict_pdf-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-predict_pdf-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;70: Plotting linear leverage from a fitted GAMLSS model.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="centile-estimation-utilities" class="level2">
<h2 class="anchored" data-anchor-id="centile-estimation-utilities">Centile estimation (Utilities)</h2>
<p>Here we use three different GAMLSS models. Note that for all centile functions the name of the x-variable should appear in the plotting function as in the actual data otherwise the function will not find it:</p>
<section id="fractional-polynomials-basis" class="level4">
<h4 class="anchored" data-anchor-id="fractional-polynomials-basis">fractional polynomials basis</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">=</span><span class="fu">gamlss</span>(head<span class="sc">~</span><span class="fu">bfp</span>(age,<span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="sc">-</span><span class="dv">1</span>,<span class="sc">-</span>.<span class="dv">5</span>,<span class="dv">0</span>,.<span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)), </span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a>           <span class="sc">~</span><span class="fu">bfp</span>(age,<span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="sc">-</span><span class="dv">1</span>,<span class="sc">-</span>.<span class="dv">5</span>,<span class="dv">0</span>,.<span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)),</span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a>           <span class="sc">~</span><span class="fu">bfp</span>(age,<span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="sc">-</span><span class="dv">1</span>,<span class="sc">-</span>.<span class="dv">5</span>,<span class="dv">0</span>,.<span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)),</span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a>           <span class="sc">~</span><span class="fu">bfp</span>(age,<span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="sc">-</span><span class="dv">1</span>,<span class="sc">-</span>.<span class="dv">5</span>,<span class="dv">0</span>,.<span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)),</span>
<span id="cb143-5"><a href="#cb143-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">data=</span>db, <span class="at">family=</span>BCTo, <span class="at">trace=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="p-splines" class="level4">
<h4 class="anchored" data-anchor-id="p-splines">P-splines</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">=</span><span class="fu">gamlss</span>(head<span class="sc">~</span><span class="fu">pb</span>(age<span class="sc">^</span>.<span class="dv">3</span>), </span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a>           <span class="sc">~</span><span class="fu">pb</span>(age<span class="sc">^</span>.<span class="dv">3</span>), </span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a>           <span class="sc">~</span><span class="fu">pb</span>(age<span class="sc">^</span>.<span class="dv">3</span>),</span>
<span id="cb144-4"><a href="#cb144-4" aria-hidden="true" tabindex="-1"></a>           <span class="sc">~</span><span class="fu">pb</span>(age<span class="sc">^</span>.<span class="dv">3</span>),</span>
<span id="cb144-5"><a href="#cb144-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">data=</span>db, <span class="at">family=</span>BCTo, <span class="at">c.crit=</span><span class="fl">0.01</span>, </span>
<span id="cb144-6"><a href="#cb144-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">trace=</span><span class="cn">FALSE</span>, <span class="at">n.cyc=</span><span class="dv">50</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="fractional-polynomials" class="level4">
<h4 class="anchored" data-anchor-id="fractional-polynomials">fractional polynomials</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a>m3 <span class="ot">=</span><span class="fu">gamlss</span>(head<span class="sc">~</span><span class="fu">fp</span>(age,<span class="dv">3</span>), </span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a>           <span class="sc">~</span><span class="fu">fp</span>(age,<span class="dv">3</span>), </span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a>           <span class="sc">~</span><span class="fu">fp</span>(age,<span class="dv">3</span>),</span>
<span id="cb145-4"><a href="#cb145-4" aria-hidden="true" tabindex="-1"></a>           <span class="sc">~</span><span class="fu">fp</span>(age,<span class="dv">3</span>),</span>
<span id="cb145-5"><a href="#cb145-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">data=</span>db, <span class="at">family=</span>BCTo, <span class="at">c.crit=</span><span class="fl">0.01</span>, </span>
<span id="cb145-6"><a href="#cb145-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">trace=</span><span class="cn">FALSE</span>, <span class="at">n.cyc=</span><span class="dv">50</span>)</span>
<span id="cb145-7"><a href="#cb145-7" aria-hidden="true" tabindex="-1"></a><span class="fu">GAIC.table</span>(m1,m2, m3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>minimum GAIC(k= 2 ) model: m2 
minimum GAIC(k= 3.84 ) model: m2 
minimum GAIC(k= 8.86 ) model: m2 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>         df      k=2   k=3.84   k=8.86
m1 36.00000 26809.37 26875.61 27056.33
m2 22.66598 26789.02 26830.73 26944.51
m3 28.00000 26978.73 27030.25 27170.81</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>This needs to be translated to <code>gamlls2</code> objects</p>
</div>
</div>
</section>
<section id="classical-functions" class="level3">
<h3 class="anchored" data-anchor-id="classical-functions">Classical functions</h3>
<p>Those the three classical GAMLSS centile functions;</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="fu">centiles</span>(m1)<span class="co">#  works</span></span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a><span class="do">#######################################################################</span></span>
<span id="cb148-3"><a href="#cb148-3" aria-hidden="true" tabindex="-1"></a><span class="fu">centiles.fan</span>(m1)<span class="co">#  works</span></span>
<span id="cb148-4"><a href="#cb148-4" aria-hidden="true" tabindex="-1"></a><span class="do">#######################################################################</span></span>
<span id="cb148-5"><a href="#cb148-5" aria-hidden="true" tabindex="-1"></a><span class="fu">centiles.com</span>(m1,m2,m3 )<span class="co"># works</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Note that you can actually can specify the x variable and produce identical results:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="fu">centiles</span>(m1, <span class="at">xvar=</span>db<span class="sc">$</span>age)<span class="co"># works</span></span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a><span class="fu">centiles</span>(m1, <span class="at">xvar=</span>age)<span class="co"># works</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="sec-fittedcentiles" class="level3">
<h3 class="anchored" data-anchor-id="sec-fittedcentiles"><code>fitted_centiles()</code></h3>
<p>The <code>fitted_centiles()</code> function, produces identical results with the function <code>centiles()</code> of <strong>gamlss</strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fitted_centiles</span>(m2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-fitted_centiles" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fitted_centiles-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="gamlss-ggplots_files/figure-html/fig-fitted_centiles-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fitted_centiles-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;71: Plotting the centiles for model <code>m2</code>.
</figcaption>
</figure>
</div>
</div>
</div>
<p>The function <code>fitted_centiles()'  can be used with</code>facet_wrap()`:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fitted_centiles</span>(m2)<span class="sc">+</span></span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="fu">cut_number</span>(db<span class="sc">$</span>age, <span class="dv">3</span>), <span class="at">scales =</span> <span class="st">"free_x"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-fitted_centiles3" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fitted_centiles3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="gamlss-ggplots_files/figure-html/fig-fitted_centiles3-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fitted_centiles3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;72: Plotting the centiles for models <code>m1</code>, <code>m2</code> and <code>m3</code>.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="sec-fittedcentileslegend" class="level3">
<h3 class="anchored" data-anchor-id="sec-fittedcentileslegend"><code>fitted_centiles_legend()</code></h3>
<p>To have legend in the plot use the following which it takes more time.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fitted_centiles_legend</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-fitted_centiles_legend" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fitted_centiles_legend-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="gamlss-ggplots_files/figure-html/fig-fitted_centiles_legend-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fitted_centiles_legend-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;73: Plotting the centiles for model <code>m2</code>.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="sec-modelcentiles" class="level3">
<h3 class="anchored" data-anchor-id="sec-modelcentiles"><code>model_centiles()</code></h3>
<p>If you wnat to check the centiles curves for all models used;</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model_centiles</span>(m1,m2,m3,  <span class="at">xvar=</span>age)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-model_centiles" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-model_centiles-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="gamlss-ggplots_files/figure-html/fig-model_centiles-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-model_centiles-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;74: Plotting the centiles for models <code>m1</code>, <code>m2</code> and <code>m3</code>.
</figcaption>
</figure>
</div>
</div>
</div>
<p>or</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model_centiles</span>(m1,m2,m3,  <span class="at">xvar=</span>age, <span class="at">in.one=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-model_centiles2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-model_centiles2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="gamlss-ggplots_files/figure-html/fig-model_centiles2-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-model_centiles2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;75: Plotting the centiles for models <code>m1</code>, <code>m2</code> and <code>m3</code>.
</figcaption>
</figure>
</div>
</div>
</div>
<p>The function <code>model_centiles(..., in.one=TRUE)'  can be used with</code>facet_wrap()`:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model_centiles</span>(m1,m2,m3, <span class="at">xvar=</span>age, <span class="at">in.one=</span><span class="cn">TRUE</span>)<span class="sc">+</span></span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="fu">cut_number</span>(db<span class="sc">$</span>age, <span class="dv">4</span>), <span class="at">scales =</span> <span class="st">"free_x"</span>)<span class="co"># working</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-model_centiles3" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-model_centiles3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="gamlss-ggplots_files/figure-html/fig-model_centiles3-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-model_centiles3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;76: Plotting the centiles for models <code>m1</code>, <code>m2</code> and <code>m3</code>.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="sec-Boostrapping" class="level2">
<h2 class="anchored" data-anchor-id="sec-Boostrapping">Boostrapping</h2>
<p><code>to be continue</code></p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>